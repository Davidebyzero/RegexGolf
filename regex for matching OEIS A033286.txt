^
(?:
	(?# Find the largest prime factor of N, and capture it in \3 )
	(?=
		(
			(x+)\2*(?=\2$)
		)*
		(x(x+))
	)
	(?# Divide: \5 = N / \3, with \6 = \5-1 )
	(?=
		(x(x*))
		(?=\5*$)
		\4\6*$
	)
	(?# Find the next smaller prime than \3 and capture it in \8, with \9 = \8 - 1 )
	(?=
		.*(?=\3$).+?
		(?!(xx+)\7+$)(x(x+))
	)
	(?=
		.*(?=\6$)(?!\8|$)     (?# Assert that \6 < \8 and \6 >= 0 )
	)
	(?# Multiply: tail = \8 * \6 )
	.*
	(?=\8+$)
	\8*
	(?=\6\9+$)
)*
xx$